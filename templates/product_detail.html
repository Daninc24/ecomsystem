{% extends "base.html" %}

{% block title %}{{ product.name }} - E-Commerce Store{% endblock %}

{% block content %}
<div class="container">
    <div class="product-detail">
        <div class="product-image">
            <img src="{{ product.image_url or '/static/images/placeholder.jpg' }}" alt="{{ product.name }}">
        </div>
        
        <div class="product-info">
            <h1>{{ product.name }}</h1>
            <p class="product-category">Category: {{ product.category }}</p>
            <p class="product-price">${{ "%.2f"|format(product.price) }}</p>
            <p class="product-stock">Stock: {{ product.stock }}</p>
            
            <div class="product-description">
                <h3>Description</h3>
                <p>{{ product.description or 'No description available.' }}</p>
            </div>
            
            {% if session.user_id and product.stock > 0 %}
            <div class="quantity-selector">
                <label for="quantity">Quantity:</label>
                <input type="number" id="quantity" min="1" max="{{ product.stock }}" value="1">
            </div>
            
            <div class="product-actions">
                <button class="btn btn-primary btn-large" id="addToCartBtn" data-product-id="{{ product.id }}">
                    Add to Cart
                </button>
            </div>
            {% elif product.stock == 0 %}
            <p class="out-of-stock">Out of Stock</p>
            {% elif not session.user_id %}
            <p><a href="{{ url_for('login') }}">Login</a> to add items to cart</p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const addToCartBtn = document.getElementById('addToCartBtn');
    
    if (addToCartBtn) {
        addToCartBtn.addEventListener('click', function() {
            const productId = this.getAttribute('data-product-id');
            const quantity = parseInt(document.getElementById('quantity').value);
            addToCart(productId, quantity);
        });
    }
});
</script>
{% endblock %}