services:
  # Web Service
  - type: web
    name: ecommerce-app
    env: python
    buildCommand: |
      pip install -r requirements.txt
      python init_data.py
    startCommand: gunicorn app:app
    envVars:
      - key: FLASK_CONFIG
        value: production
      - key: SECRET_KEY
        generateValue: true
      - key: DATABASE_URL
        fromDatabase:
          name: ecommerce-db
          property: connectionString
      - key: STRIPE_PUBLISHABLE_KEY
        value: pk_test_your_stripe_publishable_key
      - key: STRIPE_SECRET_KEY
        value: sk_test_your_stripe_secret_key
      - key: PAYPAL_CLIENT_ID
        value: your_paypal_client_id
      - key: PAYPAL_CLIENT_SECRET
        value: your_paypal_client_secret
      - key: PAYPAL_MODE
        value: sandbox
      - key: MPESA_CONSUMER_KEY
        value: your_mpesa_consumer_key
      - key: MPESA_CONSUMER_SECRET
        value: your_mpesa_consumer_secret
      - key: MPESA_SHORTCODE
        value: your_mpesa_shortcode
      - key: MPESA_PASSKEY
        value: your_mpesa_passkey
      - key: MPESA_ENVIRONMENT
        value: sandbox

  # Database
databases:
  - name: ecommerce-db
    databaseName: ecommerce
    user: ecommerce_user